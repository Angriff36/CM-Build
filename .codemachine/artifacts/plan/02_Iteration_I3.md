### Iteration 3: Recipe & Media System

- **Iteration ID:** `I3`
- **Goal:** Add recipe storage, media uploads, and viewer components.
- **Prerequisites:** I2
- **Tasks:**
  - **Task 3.1:**
    - **Task ID:** `I3.T1`
    - **Description:** Generate OpenAPI spec for API contracts.
    - **Agent Type Hint:** DocumentationAgent
    - **Inputs:** API design
    - **Input Files:** None
    - **Target Files:** api/openapi.yaml
    - **Deliverables:** OpenAPI YAML
    - **Acceptance Criteria:** Spec validates against schema
    - **Dependencies:** I2.T1
    - **Parallelizable:** Yes
  - **Task 3.2:**
    - **Task ID:** `I3.T2`
    - **Description:** Create JSON Schema for recipe JSONB.
    - **Agent Type Hint:** DocumentationAgent
    - **Inputs:** Recipe model
    - **Input Files:** libs/shared/src/models.ts
    - **Target Files:** docs/schemas/recipe.schema.json
    - **Deliverables:** JSON Schema
    - **Acceptance Criteria:** Validates recipe data
    - **Dependencies:** I1.T6
    - **Parallelizable:** Yes
  - **Task 3.3:**
    - **Task ID:** `I3.T3`
    - **Description:** Implement recipe CRUD in Supabase.
    - **Agent Type Hint:** DatabaseAgent
    - **Inputs:** Recipe schema
    - **Input Files:** docs/schemas/recipe.schema.json
    - **Target Files:** supabase/functions/create_recipe.sql
    - **Deliverables:** Recipe RPCs
    - **Acceptance Criteria:** Stores JSONB correctly
    - **Dependencies:** I3.T2
    - **Parallelizable:** No
  - **Task 3.4:**
    - **Task ID:** `I3.T4`
    - **Description:** Add media upload with signed URLs.
    - **Agent Type Hint:** BackendAgent
    - **Inputs:** Supabase Storage
    - **Input Files:** None
    - **Target Files:** supabase/functions/sign_upload.sql
    - **Deliverables:** Upload RPC
    - **Acceptance Criteria:** Issues valid signed URLs
    - **Dependencies:** I2.T2
    - **Parallelizable:** Yes
  - **Task 3.5:**
    - **Task ID:** `I3.T5`
    - **Description:** Build recipe drawer component in prepchef.
    - **Agent Type Hint:** FrontendAgent
    - **Inputs:** UI library
    - **Input Files:** libs/ui/src/
    - **Target Files:** apps/prepchef/src/components/RecipeDrawer.tsx
    - **Deliverables:** Recipe viewer
    - **Acceptance Criteria:** Displays media and steps
    - **Dependencies:** I3.T3, I1.T7
    - **Parallelizable:** Yes
  - **Task 3.6:**
    - **Task ID:** `I3.T6`
    - **Description:** Integrate media viewer with transcoding.
    - **Agent Type Hint:** FrontendAgent
    - **Inputs:** Upload flow
    - **Input Files:** supabase/functions/sign_upload.sql
    - **Target Files:** apps/prepchef/src/components/MediaViewer.tsx
    - **Deliverables:** Media component
    - **Acceptance Criteria:** Handles processing states
    - **Dependencies:** I3.T4
    - **Parallelizable:** Yes
