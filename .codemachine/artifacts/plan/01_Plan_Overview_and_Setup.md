# Project Plan: CaterKing Kitchen Management Platform

**Version:** 1.0
**Date:** Thu Dec 11 2025
**Generated By:** OpenCode AI Assistant

## 1. Project Overview

- **Goal:** Deliver a unified kitchen management platform that transforms chaotic food preparation into organized, real-time workflows by centralizing tasks, recipes, and methods across events, empowering staff to claim and complete tasks efficiently while providing managers with visibility and owners with control, resulting in streamlined execution, reduced waste, and consistent quality.

- **High-Level Requirements Summary:**
  - Real-time task dashboard displaying tasks across events with claim, unclaim, complete, and status tracking.
  - Task consolidation detecting similar tasks and allowing opt-in combination with standardized instructions and unit conversions.
  - Multi-event coordination supporting concurrent events with shared tasks and ingredients.
  - Recipes and methods knowledge base with images, videos, and editable content.
  - Permissions/roles (Staff, Manager, Event Lead, Owner) controlling access to tasks, editing, and visibility.
  - Mobile PWA for staff, web app for management, wall-mounted display for passive monitoring.
  - Real-time updates across devices with minimal latency.
  - Multi-tenant isolation ensuring data security.
  - Scalability for typical kitchen operations (up to 200 tasks, 5 events, 10 events/week).

- **Key Assumptions:**
  - Technology stack: Next.js 15, Supabase Postgres, Tailwind + ShadCN, React Query, Supabase Realtime.
  - Multi-tenant via company_id scoping with RLS.
  - Heuristics for task similarity using fuzzy text and ingredient normalization.
  - Media uploads limited to 500MB, transcoded via Supabase Functions.
  - Offline support not required; clients fail closed.
  - SSO deferred; email/password auth via Supabase.
  - No inventory or analytics in MVP.

## 2. Core Architecture

- **Architectural Style:** Modular monolithic Turbo repo with Next.js App Router, shared libraries for domain logic, and Supabase-managed backend services.

- **Technology Stack:**
  - Frontend: Next.js 15 (App Router, React Server Components), Tailwind CSS, ShadCN UI.
  - Backend: Next.js API routes, Supabase Postgres, Supabase Edge Functions.
  - Database: Supabase Postgres with JSONB for recipes/methods.
  - Messaging/Queues: Supabase Realtime channels.
  - Deployment: Vercel for frontend/API, Supabase for DB/Auth/Storage.
  - Other Key Libraries/Tools: React Query, Supabase JS client, Flagsmith for feature flags, Doppler for secrets.

- **Key Components/Services:**
  - apps/prepchef: Mobile PWA for staff task execution.
  - apps/caterking: Lightweight ops app.
  - apps/admin-crm: Web dashboard for management.
  - apps/display: Passive kiosk display.
  - libs/ui: Shared design system.
  - libs/shared: Domain models, validators, heuristics.
  - libs/supabase: Data access layer.
  - Supabase services: Postgres, Auth, Storage, Realtime, Functions.

- **Data Model Overview:**
  - Companies: Tenant isolation.
  - Users: Staff with roles.
  - Events: Catering engagements.
  - Tasks: Prep items with status, assignments.
  - Recipes/Methods: Knowledge base with media.
  - CombinedTaskGroups: Merged tasks.
  - AuditLogs: Compliance tracking.

- **API Contract Style:** REST-ish with Next.js routes, OpenAPI specs.

- **Communication Patterns:** Synchronous API calls with optimistic UI, realtime broadcasts for state sync.

## 2.1. Key Architectural Artifacts Planned

- Component Diagram (PlantUML) - To visualize major service interactions (Created in I1.T2)
- Sequence Diagrams (PlantUML) - To show interaction flows (Created in I2.T1)
- ERD (Mermaid) - To show primary entity relationships (Created in I1.T3)
- API Spec (OpenAPI YAML) - To define endpoints (Created in I2.T2)
- Data Schemas (JSON Schema) - For recipe/method payloads (Created in I1.T4)

## 3. Directory Structure

- **Root Directory:** caterking/
- **Structure Definition:**
  ```
  caterking/
  ├── apps/
  │   ├── prepchef/
  │   │   ├── app/
  │   │   ├── public/
  │   │   └── package.json
  │   ├── caterking/
  │   ├── admin-crm/
  │   └── display/
  ├── libs/
  │   ├── ui/
  │   ├── shared/
  │   ├── supabase/
  │   ├── rag/
  │   └── mcp/
  ├── supabase/
  │   ├── migrations/
  │   ├── seeds/
  │   └── functions/
  ├── docs/
  │   ├── diagrams/
  │   └── adr/
  ├── api/
  │   └── openapi/
  ├── tests/
  ├── tooling/
  ├── package.json
  └── turbo.json
  ```
